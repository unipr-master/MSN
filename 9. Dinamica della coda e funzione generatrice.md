---

---
La dinamica del processo è descritta dalla relazione ricorsiva

$$Q_{n+1} = \begin{cases} Q_n - 1 + X_{n+1} & \text{se } Q_n > 0 \\ 1 - 1 + X_{n+1} & \text{se } Q_n = 0 \end{cases}$$

La variabile $X_n$ dipende dalla quantità

$$K_j = P(X_n = j) = \int_0^{\infty} \frac{e^{-\lambda t} (\lambda t)^j}{j!} , dB(t)$$

dove i tempi di servizio $S_n$ sono distribuiti secondo

$$P(S_n \leq x) = B(x)$$

con

$$E(S_n) = b \quad \text{e} \quad V(S_n) = \sigma_s^2$$

dove $E$ indica il valore atteso (media) e $V$ la varianza.

## Che dire di $K_j$?

Ricordando il trucco usato per Ehrenfest, si fa uso della **funzione generatrice**, definita come:

$$K(z) = \sum_{j=0}^{\infty} K_j z^j \quad \text{con } |z| < 1$$

Si osserva che:

$E(X_n) = K'(1)$  
$E(X_n^2) = K''(1) + K'(1)$  
$E(X_n^3) = K'''(1) + 3K''(1) + K'(1)$

## Trasformata di Laplace e momenti degli arrivi

È utile introdurre la **trasformata di Laplace** della funzione di distribuzione $B$:

$$\psi(\nu) = \int_0^{\infty} e^{-\nu t} , dB(t) \quad \text{(con } \Re(\nu) > 0)$$

**Nota.** Le trasformate di Laplace sono strumenti molto utili in diversi contesti e sono frequentemente tabulate.

Si osserva che $b = E(S_n) = -\psi'(0)$ e $E(S_n^2) = \psi''(0)$ . Inoltre si ha

$$K(z) = \int_0^{\infty} e^{-\lambda t} \sum_{j=0}^{\infty} \frac{(\lambda z t)^j}{j!} , dB(t) = \psi(\lambda - \lambda z)$$

Derivando la funzione generatrice $K(z)$, si ottiene:

$$K'(z) = -\lambda , \psi'(\lambda - \lambda z)$$  
$$K''(z) = \lambda^2 , \psi''(\lambda - \lambda z)$$  
$$K'''(z) = -\lambda^3 , \psi'''(\lambda - \lambda z)$$

Da queste espressioni segue che:

$E(X_n) = -\lambda , \psi'(0) = \lambda b = \rho$  
$E(X_n^2) = \lambda^2 , E(S_n^2) + \rho$  
$E(X_n^3) = \lambda^3 , E(S_n^3) + 3 \lambda^2 , E(S_n^2) + \rho$

### Morale

Grazie all’uso combinato della **funzione generatrice** e della **trasformata di Laplace**, è possibile stabilire relazioni esplicite tra **tutti i momenti del numero di arrivi** e **tutti i momenti dei tempi di servizio**.

## Equazione per la distribuzione stazionaria

L’equazione per la distribuzione stazionaria è data da $W \Pi = \Pi$, che esplicitamente si traduce in:

$\Pi_0 = \Pi_0 K_0 + \Pi_1 K_0$  
$\Pi_1 = \Pi_0 K_1 + \Pi_1 K_1 + \Pi_2 K_0$  
$\Pi_2 = \Pi_0 K_2 + \Pi_1 K_2 + \Pi_2 K_1 + \Pi_3 K_0$  
$\vdots$

Nel caso di tempo di servizio costante, le $K_j$ risultano note (basta valutare una distribuzione di Poisson). Come osservato per il caso della coda con sala d’attesa, sulla prima riga ci sono inizialmente due incognite. Tuttavia, si vedrà a breve che è possibile calcolare esplicitamente l’espressione della funzione $\Pi(z)$, per cui l’unica incognita effettiva sarà $\Pi_0$. Una volta trovata, si potrà passare iterativamente alle righe successive per determinare tutte le altre componenti della distribuzione stazionaria. In questo modo il problema risulta completamente risolto.

### Funzione generatrice per $\Pi$

Si definisce la **funzione generatrice** della distribuzione stazionaria:

$$\Pi(z) = \sum_{n=0}^{\infty} \Pi_n z^n \quad \text{con } |z| < 1$$

È possibile derivare e valutare in $z = 0$ per ottenere i vari momenti.

### Sviluppo della funzione $\Pi(z)$

Moltiplicando l’equazione precedente per potenze di $z$ e sommando, si ottiene:

$$\Pi(z) = \Pi_0 K(z) + \Pi_1 z K(z) + \Pi_2 z^2 K(z) + \Pi_3 z^3 K(z) + \ldots$$  
$$= \Pi_0 K(z) + \frac{K(z)}{z} (\Pi_1 z + \Pi_2 z^2 + \Pi_3 z^3 + \ldots)$$

cioè:

$$\Pi(z) = \Pi_0 K(z) + \frac{K(z)}{z} \left( \Pi(z) - \Pi_0 \right)$$

da cui si ricava:

$$\Pi(z) \left[ 1 - \frac{K(z)}{z} \right] = \Pi_0 K(z) \left(1 - \frac{1}{z} \right)$$

e quindi la forma compatta:

$$\Pi(z) = \frac{\Pi_0 K(z) (z - 1)}{z - K(z)}$$

## Normalizzazione della distribuzione stazionaria

Essendo la somma delle probabilità uguale a $1$, si ha:

$$\sum_m \pi_m = 1 \quad \Rightarrow \quad \Pi(1) = \sum_m \pi_m = 1$$

Applicando il limite alla formula precedente, si ottiene:

$$1 = \lim_{z \to 1} \frac{\Pi_0 \left[ K(z) + (z - 1) K'(z) \right]}{1 - K(z)/z}$$

che equivale a:

$$1 = \frac{\Pi_0}{1 - \rho} \quad (\rho < 1)$$

da cui si ricava:

$$\Pi_0 = 1 - \rho$$

e infine:

$$\Pi(z) = \frac{(1 - \rho)(z - 1) K(z)}{z - K(z)}$$
